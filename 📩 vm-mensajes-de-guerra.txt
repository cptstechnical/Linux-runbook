# ðŸ§  Este servidor se utiliza como 
# ðŸ§

#=========================================================================================================================
[ðŸª–ðŸ“© ce-500]::
# DocumentaciÃ³n oficial kismet :             https://www.kismetwireless.net/docs/readme/installing/linux/
# documentaciÃ³n oficial clamav :             https://docs.clamav.net/

#=========================================================================================================================
[ðŸª–ðŸ“© INSTALAR ANTIVIRUS]::
# paquetes de Linux de utilizaciÃ³n rÃ¡pida y prÃ¡ctica (escaneres):
# ðŸ’¯ realizo la instalaciÃ³n de un antivirus para automatizar el escaner de archivos corruptos en el servidor

# instalaciÃ³n antivirus Linux:
## ðŸ‘¹ clamav::
apt install clamav
apt install clamav-freshclam
# busco actualizaciones en la base de datos
sudo freshclam
# escaneo manualmente el sistema
# clamscan -[parÃ¡metros] [ruta de carpeta]
# sudo clamscan -r /
sudo clamscan -r /home

# ðŸ‘¹ formas de uso con clamav:
# guardo un registro de archivos infectados
sudo clamscan -l /ruta/al/archivo.txt -r /ruta/al/directorio

# mandar archivo a cuarentena (para no causar daÃ±o al servidor):
# sudo clamscan --move=/path/to/quarantine -r /ruta/al/directorio
sudo clamscan --move=/path/to/quarantine -r /ruta/al/directorio -l /ruta/al/archivo.txt

# borrar archivos maliciosos:
# sudo clamscan --remove -r /ruta/al/directorio
sudo clamscan --remove -r /ruta/al/directorio -l /ruta/al/archivo.txt

# actualizar base de datos 
sudo freshclam

# lo que puedo hacer es un cron y un alias para que automatice el anÃ¡lisis de virus. 
# ðŸ†—


#=========================================================================================================================
[ðŸª–ðŸ“© MENSAJES PROGRAMADOS]::
# ðŸ§  enviarÃ¡ cad dÃ­a un mensaje programado a la misma hora (siempre que lo haya), ordenando los archivos a enviar por orden.
# ðŸ§  una vez enviado, se clasifica el mensaje dentro de la carpeta /enviados de la misma ruta y aunque permanezca en el servidor no se volverÃ¡ a mandar dicho mensaje.
# ðŸ§  al mover el mensaje a la carpeta enviados le cambia el nombre por la fecha y luego su nombree original para que no sobreescriban. Ej: 20250619_082815_nombre.txt

# creo una carpeta con los mensajes
mkdir /isaac/mensajes

# instalo postfix
apt install postfix
    - web

# ðŸ‘ðŸ“® creo el script en el caso que el correo remitente sea de dominio
vim enviar-mensaje.sh
--------------------------------------------------------------------------
#!/bin/bash

CARPETA="/isaac/mensajes"
DESTINO="to@dominio.es"               # DESTINO="primero@dominio.com, segundo@dominio.com, tercero@dominio.com"
DESTINO_OCULTO="bcc@dominio.com"      # DESTINO_OCULTO="primero@dominio.com, segundo@dominio.com, tercero@dominio.com"
ASUNTO="Nuevo mensaje"
REMITENTE="from@dominio.es"           # correo real
DESTINO_ENVIADOS="$CARPETA/enviados"

# Crear carpeta de enviados si no existe
mkdir -p "$DESTINO_ENVIADOS"

# Buscar el primer archivo por orden
archivo=$(ls "$CARPETA"/*.txt 2>/dev/null | sort | head -n 1)

if [ -n "$archivo" ]; then
    echo "Enviando: $archivo a $DESTINO (BCC: $DESTINO_OCULTO)"

    (
        echo "Subject: $ASUNTO"
        echo "From: $REMITENTE"
        echo "To: $DESTINO"
        echo "Bcc: $DESTINO_OCULTO"
        echo "Content-Type: text/plain; charset=utf-8"
        echo
        cat "$archivo"
    ) | sendmail -f "$REMITENTE" -t

    if [ $? -eq 0 ]; then
        echo "Correo enviado exitosamente."
        nombre=$(basename "$archivo")
        timestamp=$(date +%Y%m%d_%H%M%S)
        mv "$archivo" "$DESTINO_ENVIADOS/${timestamp}_$nombre"
    else
        echo "Error al enviar el correo."
    fi
else
    echo "No hay mensajes pendientes por enviar."
fi
--------------------------------------------------------------------------
